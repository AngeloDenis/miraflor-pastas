<script>
const products = [
  {name:"Fideos 500g", price:1500},
  {name:"Empanadas 300g", price:1000},
  {name:"Empanadas 400g", price:1200},
  {name:"Rotiseros", price:1300},
  {name:"√Årabes", price:1500},
  {name:"Copet√≠n", price:1400},
  {name:"Tartas 300g", price:1100},
  {name:"Tartas 400g", price:1300},
  {name:"Pastelitos 8x8", price:1200},
  {name:"Pastelon 10x10", price:1500}
];

let cart = {};

function renderProducts() {
  let html = "";
  products.forEach((p, i) => {
    html += `
      <div class="product">
        <div>
          <b>${p.name}</b><br>$${p.price}
        </div>
        <div>
          <input type="number" id="qty${i}" value="1" min="1" style="width:60px;">
          <button onclick="addToCart(${i})">Agregar</button>
        </div>
      </div>
    `;
  });
  document.getElementById("products").innerHTML = html;
}

function addToCart(index) {
  const product = products[index];
  const qty = parseInt(document.getElementById("qty" + index).value);

  if (!cart[product.name]) {
    cart[product.name] = { qty: 0, price: product.price };
  }

  cart[product.name].qty += qty;
  renderCart();
}

function renderCart() {
  let html = "";
  let total = 0;
  let units = 0;

  for (let name in cart) {
    const item = cart[name];
    html += `${item.qty} x ${name} - $${item.qty * item.price}<br>`;
    total += item.qty * item.price;
    units += item.qty;
  }

  html += `<hr><b>Total: $${total}</b>`;
  document.getElementById("cartItems").innerHTML = html;

  cart.total = total;
  cart.units = units;
}

function toggleAddress() {
  document.getElementById("addressBox").style.display =
    document.getElementById("delivery").value === "Env√≠o" ? "block" : "none";
}

function sendWhatsApp() {
  if (document.getElementById("delivery").value === "Env√≠o" && cart.units < 10) {
    alert("El env√≠o es a partir de 10 unidades");
    return;
  }

  let msg = "üßæ *Nuevo pedido*%0A";
  msg += "Nombre: " + name.value + "%0A";
  msg += "Tel: " + phone.value + "%0A%0A";
  msg += "Entrega: " + delivery.value + "%0A";

  if (delivery.value === "Env√≠o") {
    msg += "Direcci√≥n: " + address.value + "%0A%0A";
  }

  for (let name in cart) {
    msg += `${cart[name].qty} x ${name}%0A`;
  }

  msg += `%0ATotal: $${cart.total}`;

  window.open("https://wa.me/5493406519939?text=" + msg, "_blank");
}

renderProducts();
</script>
