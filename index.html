<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Miraflor Pastas</title>

<style>
body { font-family: Arial, sans-serif; background:#f6f6f6; padding:15px; }
.logo { text-align:center; margin-bottom:10px; }
.logo img { max-width:180px; }

.product {
  background:white;
  padding:10px;
  margin-bottom:10px;
  border-radius:8px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

button {
  background:#2e7d32;
  color:white;
  border:none;
  padding:6px 10px;
  border-radius:6px;
  cursor:pointer;
}

.remove { background:#c62828; margin-left:8px; }
.clear { background:#555; width:100%; margin:10px 0; padding:10px; }
.qty { width:60px; }

#cart {
  background:white;
  padding:15px;
  border-radius:8px;
  margin-top:20px;
}

.send {
  background:#1fa855;
  width:100%;
  padding:12px;
  font-size:18px;
  margin-top:10px;
}
</style>
</head>

<body>

<div class="logo">
  <img src="logo.png" alt="Miraflor">
</div>

<h2 style="text-align:center">游꼫 Miraflor Pastas</h2>

<p style="text-align:center">
游닍 Env칤os a partir de 10 unidades<br>
游낅 Retiro en f치brica: Estrada 5670
</p>

<div id="products"></div>

<div id="cart">
<h3>游 Carrito</h3>
<div id="cartItems"><i>El carrito est치 vac칤o</i></div>

<button class="clear" onclick="clearCart()">Vaciar carrito</button>

<input id="nameInput" placeholder="Nombre">
<input id="phoneInput" placeholder="Tel칠fono">

<select id="deliverySelect" onchange="toggleAddress()">
  <option value="">Entrega</option>
  <option value="Env칤o">Env칤o</option>
  <option value="Retiro en f치brica">Retiro en f치brica</option>
</select>

<div id="addressBox" style="display:none">
<textarea id="addressInput" placeholder="Direcci칩n completa"></textarea>
</div>

<button class="send" onclick="confirmOrder()">Confirmar pedido</button>
</div>

<script>
const products = [
  {name:"Fideos 500g", price:1500},
  {name:"Empanadas 300g", price:1000},
  {name:"Empanadas 400g", price:1200},
  {name:"Rotiseros", price:1300},
  {name:"츼rabes", price:1500},
  {name:"Copet칤n", price:1400},
  {name:"Tartas 300g", price:1100},
  {name:"Tartas 400g", price:1300},
  {name:"Pastelitos 8x8", price:1200},
  {name:"Pastelon 10x10", price:1500}
];

let cart = {};

function renderProducts() {
  let html = "";
  products.forEach((p,i)=>{
    html += `
      <div class="product">
        <div><b>${p.name}</b><br>$${p.price}</div>
        <div>
          <input class="qty" type="number" min="1" value="1" id="q${i}">
          <button onclick="addProduct(${i})">Agregar</button>
        </div>
      </div>
    `;
  });
  document.getElementById("products").innerHTML = html;
}

function addProduct(i) {
  const p = products[i];
  const q = parseInt(document.getElementById("q"+i).value);

  if (!cart[p.name]) cart[p.name] = {q:0, price:p.price};
  cart[p.name].q += q;
  renderCart();
}

function removeItem(name) {
  cart[name].q--;
  if (cart[name].q <= 0) delete cart[name];
  renderCart();
}

function clearCart() {
  cart = {};
  renderCart();
}

function renderCart() {
  let html = "";
  let total = 0;

  for (let k in cart) {
    html += `${cart[k].q} x ${k} - $${cart[k].q * cart[k].price}
    <button class="remove" onclick="removeItem('${k}')">Quitar</button><br>`;
    total += cart[k].q * cart[k].price;
  }

  document.getElementById("cartItems").innerHTML =
    html === "" ? "<i>El carrito est치 vac칤o</i>" : html + `<hr><b>Total: $${total}</b>`;
}

function toggleAddress() {
  const delivery = document.getElementById("deliverySelect").value;
  document.getElementById("addressBox").style.display =
    delivery === "Env칤o" ? "block" : "none";
}

function confirmOrder() {
  const name = document.getElementById("nameInput").value.trim();
  const phone = document.getElementById("phoneInput").value.trim();
  const delivery = document.getElementById("deliverySelect").value;
  const address = document.getElementById("addressInput").value.trim();

  if (!name || !phone) {
    alert("Complet치 nombre y tel칠fono");
    return;
  }

  if (!delivery) {
    alert("Seleccion치 Env칤o o Retiro");
    return;
  }

  let total = 0;
  let units = 0;
  let resumen = "CONFIRMAR PEDIDO\n\n";

  for (let k in cart) {
    resumen += `${cart[k].q} x ${k}\n`;
    total += cart[k].q * cart[k].price;
    units += cart[k].q;
  }

  if (units === 0) {
    alert("El carrito est치 vac칤o");
    return;
  }

  resumen += `\nTotal: $${total}\nEntrega: ${delivery}\n`;

  if (delivery === "Env칤o") {
    if (units < 10) {
      alert("El env칤o es a partir de 10 unidades");
      return;
    }
    if (!address) {
      alert("Complet치 la direcci칩n");
      return;
    }
    resumen += `Direcci칩n: ${address}\n`;
  }

  if (confirm(resumen)) {
    let msg = "游 *Pedido Miraflor*%0A";
    msg += "Nombre: " + name + "%0A";
    msg += "Tel: " + phone + "%0A";
    msg += "Entrega: " + delivery + "%0A";
    if (delivery === "Env칤o") msg += "Direcci칩n: " + address + "%0A";
    msg += "%0A";

    for (let k in cart) {
      msg += `${cart[k].q} x ${k}%0A`;
    }

    msg += `%0ATotal: $${total}%0A%0A`;
    msg += "Gracias por tu pedido 游뗿 En breve te respondemos.";

    window.location.href = "https://wa.me/5493406519939?text=" + msg;
  }
}

renderProducts();
</script>

</body>
</html>
